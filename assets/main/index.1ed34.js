window.__require=function t(e,n,o){function i(c,a){if(!n[c]){if(!e[c]){var s=c.split("/");if(s=s[s.length-1],!e[s]){var u="function"==typeof __require&&__require;if(!a&&u)return u(s,!0);if(r)return r(s,!0);throw new Error("Cannot find module '"+c+"'")}c=s}var l=n[c]={exports:{}};e[c][0].call(l.exports,function(t){return i(e[c][1][t]||t)},l,l.exports,t,e,n,o)}return n[c].exports}for(var r="function"==typeof __require&&__require,c=0;c<o.length;c++)i(o[c]);return i}({AudioCommon:[function(t,e,n){"use strict";cc._RF.push(e,"7208fP+uQdOZZXFx7clM+ln","AudioCommon");var o=this&&this.__awaiter||function(t,e,n,o){return new(n||(n=Promise))(function(i,r){function c(t){try{s(o.next(t))}catch(e){r(e)}}function a(t){try{s(o.throw(t))}catch(e){r(e)}}function s(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n(function(t){t(e)})).then(c,a)}s((o=o.apply(t,e||[])).next())})},i=this&&this.__generator||function(t,e){var n,o,i,r,c={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return r={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function a(t){return function(e){return s([t,e])}}function s(r){if(n)throw new TypeError("Generator is already executing.");for(;c;)try{if(n=1,o&&(i=2&r[0]?o.return:r[0]?o.throw||((i=o.return)&&i.call(o),0):o.next)&&!(i=i.call(o,r[1])).done)return i;switch(o=0,i&&(r=[2&r[0],i.value]),r[0]){case 0:case 1:i=r;break;case 4:return c.label++,{value:r[1],done:!1};case 5:c.label++,o=r[1],r=[0];continue;case 7:r=c.ops.pop(),c.trys.pop();continue;default:if(!(i=(i=c.trys).length>0&&i[i.length-1])&&(6===r[0]||2===r[0])){c=0;continue}if(3===r[0]&&(!i||r[1]>i[0]&&r[1]<i[3])){c.label=r[1];break}if(6===r[0]&&c.label<i[1]){c.label=i[1],i=r;break}if(i&&c.label<i[2]){c.label=i[2],c.ops.push(r);break}i[2]&&c.ops.pop(),c.trys.pop();continue}r=e.call(t,c)}catch(a){r=[6,a],o=0}finally{n=i=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}};Object.defineProperty(n,"__esModule",{value:!0});var r=t("./ConfigCommon"),c=t("./LoadCommon"),a=t("./LocalStorageCommon"),s=function(){function t(){}return t.init=function(){return o(this,void 0,void 0,function(){return i(this,function(t){switch(t.label){case 0:return[4,c.default.loadBundle("audio")];case 1:return t.sent(),this.audios=r.default.getTable("audio"),[2,!0]}})})},t.play=function(t,e){void 0===e&&(e=!1),1==this.audios[t].type?this._playMusic(t,e):this._playEffect(t,e)},t._playMusic=function(t,e){if(void 0===e&&(e=!0),(!this.isMusicPlaying||this.lastAudioName!=t)&&(this.lastAudioName=t,this.isMusicOpen())){var n=this.audios[t];c.default.loadAsset({path:n.path,bundleName:"audio",type:cc.AudioClip}).then(function(t){cc.audioEngine.playMusic(t,e)}),this.isMusicPlaying=!0}},t._playEffect=function(t,e){var n=this;if(void 0===e&&(e=!1),this.isEffectOpen()){var o=this.audios[t],i=function(){c.default.loadAsset({path:o.path,bundleName:"audio",type:cc.AudioClip}).then(function(o){n.effectPlayingIds[t]=cc.audioEngine.playEffect(o,e),n.effectLastTime[t]=(new Date).getTime()})},r=this.effectLastTime[t];r?(new Date).getTime()-r>=1e3*o.interval&&i():i()}},t.stop=function(t){if(1==this.audios[t].type)cc.audioEngine.stopMusic(),this.lastAudioName="",this.isMusicPlaying=!1;else{var e=this.effectPlayingIds[t];if(null==e)return;cc.audioEngine.stopEffect(e)}},t.openMusic=function(){this._setAudioState(!0,!0),a.default.setInt("AudioCommon_Music_State",1)},t.closeMusic=function(){this.isMusicPlaying=!1,this._setAudioState(!0,!1),a.default.setInt("AudioCommon_Music_State",0)},t.openEffect=function(){this._setAudioState(!1,!0),a.default.setInt("AudioCommon_Effect_State",1)},t.closeEffect=function(){this._setAudioState(!1,!1),a.default.setInt("AudioCommon_Effect_State",0)},t.isMusicOpen=function(){var t=a.default.getInt("AudioCommon_Music_State",-1);return-1==t&&(a.default.setInt("AudioCommon_Music_State",1),t=1),null==this.isCanPlayMusic&&(this.isCanPlayMusic=1==t),this.isCanPlayMusic},t.isEffectOpen=function(){var t=a.default.getInt("AudioCommon_Effect_State",-1);return-1==t&&(a.default.setInt("AudioCommon_Effect_State",1),t=1),null==this.isCanPlayEffect&&(this.isCanPlayEffect=1==t),this.isCanPlayEffect},t._setAudioState=function(t,e){t?this.isCanPlayMusic=e:this.isCanPlayEffect=e,e?t&&this.lastAudioName&&this._playMusic(this.lastAudioName):t?cc.audioEngine.stopMusic():cc.audioEngine.stopAllEffects()},t.isCanPlayMusic=null,t.isCanPlayEffect=null,t.lastAudioName="",t.effectLastTime=Object.create(null),t.effectPlayingIds=Object.create(null),t.isMusicPlaying=null,t.audios=null,t}();n.default=s,cc._RF.pop()},{"./ConfigCommon":"ConfigCommon","./LoadCommon":"LoadCommon","./LocalStorageCommon":"LocalStorageCommon"}],ConfigCommon:[function(t,e,n){"use strict";cc._RF.push(e,"5df1eZsUZpAupXCvR5yjpn4","ConfigCommon");var o=this&&this.__awaiter||function(t,e,n,o){return new(n||(n=Promise))(function(i,r){function c(t){try{s(o.next(t))}catch(e){r(e)}}function a(t){try{s(o.throw(t))}catch(e){r(e)}}function s(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n(function(t){t(e)})).then(c,a)}s((o=o.apply(t,e||[])).next())})},i=this&&this.__generator||function(t,e){var n,o,i,r,c={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return r={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function a(t){return function(e){return s([t,e])}}function s(r){if(n)throw new TypeError("Generator is already executing.");for(;c;)try{if(n=1,o&&(i=2&r[0]?o.return:r[0]?o.throw||((i=o.return)&&i.call(o),0):o.next)&&!(i=i.call(o,r[1])).done)return i;switch(o=0,i&&(r=[2&r[0],i.value]),r[0]){case 0:case 1:i=r;break;case 4:return c.label++,{value:r[1],done:!1};case 5:c.label++,o=r[1],r=[0];continue;case 7:r=c.ops.pop(),c.trys.pop();continue;default:if(!(i=(i=c.trys).length>0&&i[i.length-1])&&(6===r[0]||2===r[0])){c=0;continue}if(3===r[0]&&(!i||r[1]>i[0]&&r[1]<i[3])){c.label=r[1];break}if(6===r[0]&&c.label<i[1]){c.label=i[1],i=r;break}if(i&&c.label<i[2]){c.label=i[2],c.ops.push(r);break}i[2]&&c.ops.pop(),c.trys.pop();continue}r=e.call(t,c)}catch(a){r=[6,a],o=0}finally{n=i=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}};Object.defineProperty(n,"__esModule",{value:!0});var r=function(){function t(){}return t.init=function(){return o(this,void 0,void 0,function(){return i(this,function(t){switch(t.label){case 0:return[4,this._loadConfig()];case 1:return t.sent(),[2,!0]}})})},t._loadConfig=function(){var t=this;return new Promise(function(e){cc.resources.load("config/config",cc.JsonAsset,function(n,o){if(n)console.log("[ConfigCommon][_loadConfig] load error = ",n);else{for(var i in o.json)t.configs[i]=o.json[i];e(t.configs)}})})},t.isExistTable=function(t){return!!this.configs[t]},t.getTable=function(t){return this.configs[t]||(console.log("[ConfigCommon][getTable] Table:["+t+"] is not exist"),null)},t.getRow=function(t,e){var n=this.getTable(t);return n?n[e]||(console.log("[ConfigCommon][getRow] Table:["+t+"],Row:["+e+"] is not exist"),null):null},t.getCol=function(t,e,n){var o=this.getRow(t,e);return o?o[n]||(console.log("[ConfigCommon][getCol] Table:["+t+"],Row:["+e+"],Col:["+n+"] is not exist"),null):null},t.configs=Object.create(null),t}();n.default=r,cc._RF.pop()},{}],GameConfig:[function(t,e){"use strict";cc._RF.push(e,"ce6b7U8mnFAqqHkuUESRcxQ","GameConfig");var n=new function(){this.isEditor=0,this.Props={201:3,202:3,203:3},this.LocalKeys={CurLevel:"CurLevel",ResetTime:"ResetTime",CurCoin:"CurCoin"},this.CoinNum=100};window.GameConfig=n,cc._RF.pop()},{}],ImageCommon:[function(t,e,n){"use strict";cc._RF.push(e,"a0bbeJBGW1J7qeLmR+JpnyF","ImageCommon");var o=this&&this.__awaiter||function(t,e,n,o){return new(n||(n=Promise))(function(i,r){function c(t){try{s(o.next(t))}catch(e){r(e)}}function a(t){try{s(o.throw(t))}catch(e){r(e)}}function s(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n(function(t){t(e)})).then(c,a)}s((o=o.apply(t,e||[])).next())})},i=this&&this.__generator||function(t,e){var n,o,i,r,c={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return r={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function a(t){return function(e){return s([t,e])}}function s(r){if(n)throw new TypeError("Generator is already executing.");for(;c;)try{if(n=1,o&&(i=2&r[0]?o.return:r[0]?o.throw||((i=o.return)&&i.call(o),0):o.next)&&!(i=i.call(o,r[1])).done)return i;switch(o=0,i&&(r=[2&r[0],i.value]),r[0]){case 0:case 1:i=r;break;case 4:return c.label++,{value:r[1],done:!1};case 5:c.label++,o=r[1],r=[0];continue;case 7:r=c.ops.pop(),c.trys.pop();continue;default:if(!(i=(i=c.trys).length>0&&i[i.length-1])&&(6===r[0]||2===r[0])){c=0;continue}if(3===r[0]&&(!i||r[1]>i[0]&&r[1]<i[3])){c.label=r[1];break}if(6===r[0]&&c.label<i[1]){c.label=i[1],i=r;break}if(i&&c.label<i[2]){c.label=i[2],c.ops.push(r);break}i[2]&&c.ops.pop(),c.trys.pop();continue}r=e.call(t,c)}catch(a){r=[6,a],o=0}finally{n=i=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}};Object.defineProperty(n,"__esModule",{value:!0});var r=t("./ConfigCommon"),c=t("./LoadCommon"),a=function(){function t(){}return t.init=function(){return o(this,void 0,void 0,function(){return i(this,function(){return this.images=r.default.getTable("image"),[2,!0]})})},t.setImageToTarget=function(t,e){if(t&&e){var n=null;t instanceof cc.Node?(n=t.getComponent(cc.Sprite))||(n=t.addComponent(cc.Sprite)):t instanceof cc.Sprite&&(n=t),n&&this.loadImageToSprite(n,e)}},t.loadImageToSprite=function(t,e,n){if(!e||!cc.isValid(t))return!1;var o=this.getById(e);return!!o&&(c.default.loadAsset({path:o.path,bundleName:o.bundle,type:cc.SpriteFrame}).then(function(e){t.spriteFrame=e,n&&n(t)}),!0)},t.loadImg=function(t,e){var n=this.getById(t);c.default.loadAsset({path:n.path,bundleName:n.bundle,type:cc.SpriteFrame}).then(function(t){e&&e(t)})},t.loadImgToTarget=function(t,e,n){t&&this.loadImg(t,function(t){e instanceof cc.Sprite?e.spriteFrame=t:e instanceof cc.Node&&((e=e.getComponent(cc.Sprite)).spriteFrame=t),n&&n()})},t.getById=function(t){return this.images[t]},t.images=null,t}();n.default=a,cc._RF.pop()},{"./ConfigCommon":"ConfigCommon","./LoadCommon":"LoadCommon"}],Interface:[function(t,e,n){"use strict";cc._RF.push(e,"5bdb6esH2RB644Xs8kyqymC","Interface"),Object.defineProperty(n,"__esModule",{value:!0}),n.UISort=void 0,function(t){t[t.BACKGROUND=0]="BACKGROUND",t[t.NORMAL=1]="NORMAL",t[t.TOP=2]="TOP",t[t.DIALOG=3]="DIALOG",t[t.GUIDE=4]="GUIDE"}(n.UISort||(n.UISort={})),cc._RF.pop()},{}],ItemSystem:[function(t,e,n){"use strict";cc._RF.push(e,"0abcce4gTpNjrPQVZbM70f+","ItemSystem"),Object.defineProperty(n,"__esModule",{value:!0});var o=t("../common/ConfigCommon"),i=t("../common/LocalStorageCommon"),r=function(){function t(){}return Object.defineProperty(t,"localStorage",{get:function(){return this.localData||(this.localData=i.default.getObject(this.localStorageKey,Object.create(null)),this.localData.items||(this.localData.items=Object.create(null))),this.localData},enumerable:!1,configurable:!0}),t.init=function(){return this.initItems(),Promise.resolve(!0)},t.initItems=function(){this.configs=o.default.getTable(TableConfig.Item.TName);var t=!1;for(var e in this.configs)this.localStorage.items[this.configs[e].id]||(this.localStorage.items[this.configs[e].id]=0,t=!0);t&&this.saveData()},t.saveData=function(){i.default.setObject(this.localStorageKey,this.localStorage)},t.addItemByList=function(t,e){if(void 0===e&&(e=!0),t||!(t.length<=0)){for(var n=[],o=null,i=0,r=t;i<r.length;i++){var c=r[i];(o=this.addItem(c.id,c.count))&&n.push(o)}this.saveData()}},t.addItem=function(t,e){return this.isPassMaxLimit(t,e)||e<=0?null:(e=Math.min(this.getMaxCountById(t)||e,e),this.localStorage.items[t]+=e,{id:t,count:e})},t.reduceItem=function(t,e,n){void 0===n&&(n=!0),this.isNotEnough(t,e,n)||e<=0||(this.localStorage.items[t]-=e,this.saveData())},t.isNotEnough=function(t,e,n){return void 0===n&&(n=!0),this.getCountById(t)-e<0},t.isPassMaxLimit=function(t,e){var n=this.getMaxCountById(t);return 0!=n&&n>=e},t.getMaxCountById=function(t){var e=this.getById(t);if(e)return e.maxCount},t.getItems=function(){return this.localStorage.items},t.getCountById=function(t){return this.localStorage.items[t]||0},t.getById=function(t){return this.configs[t]},t.localStorageKey="ItemSystemDataKey",t.localData=null,t.configs=null,t}();n.default=r,cc._RF.pop()},{"../common/ConfigCommon":"ConfigCommon","../common/LocalStorageCommon":"LocalStorageCommon"}],LinkedList:[function(t,e,n){"use strict";cc._RF.push(e,"b9957TZ8XFGoLAqpvDa9eMl","LinkedList"),Object.defineProperty(n,"__esModule",{value:!0});n.default=function(){},cc._RF.pop()},{}],LoadCommon:[function(t,e,n){"use strict";cc._RF.push(e,"7ef88lGHrFMEbRzCZPdoiEf","LoadCommon"),Object.defineProperty(n,"__esModule",{value:!0});var o=function(){function t(){}return t.loadBundle=function(t){var e=this.bundles,n=cc.assetManager.getBundle(t);return null!=n?Promise.resolve(n):(e[t]||(e[t]=new Promise(function(n){cc.assetManager.loadBundle(t,function(o,i){delete e[t],n&&n(i)})})),e[t])},t.loadBundles=function(t){var e=this;return new Promise(function(n){for(var o=t.length,i=!0,r=0;r<t.length;r++){var c=t[r];null==c||cc.assetManager.getBundle(c)?0==--o&&n&&n(i):e.loadBundle(c).then(function(t){t||(i=!1),0==--o&&n&&n(i)})}})},t.getBundle=function(t){var e=null;return e||(e=t&&"resources"!=t?cc.assetManager.getBundle(t):cc.resources),e},t.loadAsset=function(t){var e=this.getBundle(t.bundleName),n=e.get(t.path,t.type);return n?Promise.resolve(n):new Promise(function(n){e.load(t.path,t.type,function(t,e){n(e)})})},t.loadRemote=function(t){null==t.option&&(t.option={});var e=t.url,n=t.option;return new Promise(function(t){cc.assetManager.loadRemote(e,n,function(e,n){t&&t(n)})})},t.bundles=Object.create(null),t}();n.default=o,cc._RF.pop()},{}],Loading:[function(t,e,n){"use strict";cc._RF.push(e,"a4e36q62nhCz5j7azSYDQ4Y","Loading");var o,i=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),r=this&&this.__decorate||function(t,e,n,o){var i,r=arguments.length,c=r<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(t,e,n,o);else for(var a=t.length-1;a>=0;a--)(i=t[a])&&(c=(r<3?i(c):r>3?i(e,n,c):i(e,n))||c);return r>3&&c&&Object.defineProperty(e,n,c),c},c=this&&this.__awaiter||function(t,e,n,o){return new(n||(n=Promise))(function(i,r){function c(t){try{s(o.next(t))}catch(e){r(e)}}function a(t){try{s(o.throw(t))}catch(e){r(e)}}function s(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n(function(t){t(e)})).then(c,a)}s((o=o.apply(t,e||[])).next())})},a=this&&this.__generator||function(t,e){var n,o,i,r,c={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return r={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function a(t){return function(e){return s([t,e])}}function s(r){if(n)throw new TypeError("Generator is already executing.");for(;c;)try{if(n=1,o&&(i=2&r[0]?o.return:r[0]?o.throw||((i=o.return)&&i.call(o),0):o.next)&&!(i=i.call(o,r[1])).done)return i;switch(o=0,i&&(r=[2&r[0],i.value]),r[0]){case 0:case 1:i=r;break;case 4:return c.label++,{value:r[1],done:!1};case 5:c.label++,o=r[1],r=[0];continue;case 7:r=c.ops.pop(),c.trys.pop();continue;default:if(!(i=(i=c.trys).length>0&&i[i.length-1])&&(6===r[0]||2===r[0])){c=0;continue}if(3===r[0]&&(!i||r[1]>i[0]&&r[1]<i[3])){c.label=r[1];break}if(6===r[0]&&c.label<i[1]){c.label=i[1],i=r;break}if(i&&c.label<i[2]){c.label=i[2],c.ops.push(r);break}i[2]&&c.ops.pop(),c.trys.pop();continue}r=e.call(t,c)}catch(a){r=[6,a],o=0}finally{n=i=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}};Object.defineProperty(n,"__esModule",{value:!0});var s=t("../core/common/AudioCommon"),u=t("../core/common/ConfigCommon"),l=t("../core/common/ImageCommon"),f=t("../core/common/LocalStorageCommon"),d=t("../core/system/ItemSystem"),h=cc._decorator,p=h.ccclass,m=(h.property,function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype.onLoad=function(){return c(this,void 0,void 0,function(){var t,e,n,o;return a(this,function(i){switch(i.label){case 0:return[4,u.default.init()];case 1:return i.sent(),[4,l.default.init()];case 2:return i.sent(),[4,s.default.init()];case 3:return i.sent(),[4,d.default.init()];case 4:if(i.sent(),t=Number(f.default.getInt(GameConfig.LocalKeys.ResetTime))||0,(new Date).getTime()>=t){for(e=[TableConfig.Item[201],TableConfig.Item[202],TableConfig.Item[203]],n=0;n<e.length;n++)console.log("i=="+e[n]),d.default.addItem(e[n],GameConfig.Props[e[n]]);(o=new Date).setHours(0),o.setMinutes(0),o.setSeconds(0),o.setMilliseconds(0),f.default.setInt(GameConfig.LocalKeys.ResetTime,o.getTime()+864e5)}return console.log("111111111111111111111111"),cc.director.loadScene("Main"),[2]}})})},r([p],e)}(cc.Component));n.default=m,cc._RF.pop()},{"../core/common/AudioCommon":"AudioCommon","../core/common/ConfigCommon":"ConfigCommon","../core/common/ImageCommon":"ImageCommon","../core/common/LocalStorageCommon":"LocalStorageCommon","../core/system/ItemSystem":"ItemSystem"}],LocalStorageCommon:[function(t,e,n){"use strict";cc._RF.push(e,"87b6bodAjBKuoJaiTnzBELn","LocalStorageCommon"),Object.defineProperty(n,"__esModule",{value:!0});var o=function(){function t(){}return t.getString=function(t,e){return void 0===e&&(e=""),cc.sys.localStorage.getItem(t)||e||null},t.setString=function(t,e){t?cc.sys.localStorage.setItem(t,e):console.warn("[LocalStorageCommon][setString] Key\uff1a["+t+"] is null,please check")},t.getObject=function(t,e){void 0===e&&(e=null);var n=null,o=this.getString(t);if(!o)return e||null;try{n=JSON.parse(o)}catch(i){throw i}return n},t.setObject=function(t,e){var n="";try{n=JSON.stringify(e)}catch(o){throw o}this.setString(t,n)},t.getInt=function(t,e){void 0===e&&(e=0);var n=this.getString(t);if(!n)return e||0;var o=Number(n);return isNaN(o)&&console.error("[LocalStorageCommon][setString] Key\uff1a["+t+"],value = ["+n+"] isNaN"),o},t.setInt=function(t,e){this.setString(t,e.toString())},t}();n.default=o,cc._RF.pop()},{}],Main:[function(t,e,n){"use strict";cc._RF.push(e,"293fcbmnmdBCKKUmnffL6zw","Main");var o,i=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),r=this&&this.__decorate||function(t,e,n,o){var i,r=arguments.length,c=r<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(t,e,n,o);else for(var a=t.length-1;a>=0;a--)(i=t[a])&&(c=(r<3?i(c):r>3?i(e,n,c):i(e,n))||c);return r>3&&c&&Object.defineProperty(e,n,c),c};Object.defineProperty(n,"__esModule",{value:!0});var c=t("../core/common/LocalStorageCommon"),a=t("../ui/UIEditor"),s=t("../ui/UIMain"),u=cc._decorator,l=u.ccclass,f=(u.property,function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype.onLoad=function(){},e.prototype.start=function(){-1==c.default.getInt(GameConfig.LocalKeys.CurLevel,-1)&&c.default.setInt(GameConfig.LocalKeys.CurLevel,1),console.log("localkeys =="+GameConfig.LocalKeys.CurLevel),GameConfig.CoinNum=c.default.getInt(GameConfig.LocalKeys.CurCoin,-1),-1==GameConfig.CoinNum&&(c.default.setInt(GameConfig.LocalKeys.CurCoin,100),GameConfig.CoinNum=100),console.log("coinNum ==="+GameConfig.CoinNum),GameConfig.isEditor?a.default.instance.open():s.default.instance.open()},r([l],e)}(cc.Component));n.default=f,cc._RF.pop()},{"../core/common/LocalStorageCommon":"LocalStorageCommon","../ui/UIEditor":"UIEditor","../ui/UIMain":"UIMain"}],Stack:[function(t,e,n){"use strict";cc._RF.push(e,"20f43OIBjZBAZ3vPUM9E3ke","Stack"),Object.defineProperty(n,"__esModule",{value:!0});var o=function(){function t(){this._stacks=Object.create(null),this._index=0}return Object.defineProperty(t.prototype,"length",{get:function(){return this._index},enumerable:!1,configurable:!0}),t.prototype.push=function(t){return this._stacks[this._index++]=t,this},t.prototype.pop=function(){if(this._index<=0)throw"stack length illegal";this._index--;var t=this._stacks[this._index];return delete this._stacks[this._index],t},t}();n.default=o,cc._RF.pop()},{}],TAction:[function(t,e,n){"use strict";cc._RF.push(e,"eec772AbIBE3Ypono8gznkw","TAction"),Object.defineProperty(n,"__esModule",{value:!0});var o=function(){function t(){}return t.prototype.shake=function(t,e){void 0===e&&(e=.5);var n=10*e;cc.tween(t).by(.15,{x:n,y:n}).by(.15,{x:-n,y:-n}).by(.15,{x:n,y:n}).by(.15,{x:-n,y:-n}).start()},t.prototype.fadeIn=function(t,e,n){void 0===e&&(e=1);var o=t.opacity;t.opacity=0,cc.tween(t).to(e,{opacity:o}).call(function(){n&&n()}).start()},t.prototype.fadeOut=function(t,e,n){void 0===e&&(e=1),cc.tween(t).to(e,{opacity:0}).call(function(){n&&n()}).start()},t.prototype.scaleIn=function(t,e,n,o){void 0===e&&(e=.5),void 0===o&&(o="bounceOut");var i=t.scale;t.scale=0,cc.tween(t).to(e,{scale:i},{easing:o}).call(function(){n&&n()}).start()},t.prototype.scaleOut=function(t,e,n,o){void 0===e&&(e=.5),void 0===o&&(o="bounceIn"),cc.tween(t).to(e,{scale:0},{easing:o}).call(function(){n&&n()}).start()},t}();n.default=o,cc._RF.pop()},{}],TMath:[function(t,e,n){"use strict";cc._RF.push(e,"ebfc41gBcFDxIHFn35BG7rt","TMath");var o=this&&this.__spreadArrays||function(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;var o=Array(t),i=0;for(e=0;e<n;e++)for(var r=arguments[e],c=0,a=r.length;c<a;c++,i++)o[i]=r[c];return o};Object.defineProperty(n,"__esModule",{value:!0});var i=function(){function t(){}return t.random=function(t,e,n){void 0===n&&(n=!1);var o=Math.random()*(e-t);return n?Math.round(o)+t:o+t},t.objectValToArray=function(t,e){for(var n in e=e||[],t)e.push(t[n]);return e},t.shuffleArray=function(t){for(var e,n=t.length-1;n>0;n--){var o=Math.floor(Math.random()*(n+1));e=[t[o],t[n]],t[n]=e[0],t[o]=e[1]}return t},t.randomArray=function(t,e){if(t.length<e)return t;for(var n=[],i=o(t),r=0;r<e;r++){var c=this.random(0,i.length-1,!0),a=i.splice(c,1)[0];n.push(a)}return n},t.randomStr=function(t,e){void 0===e&&(e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789");for(var n="",o=e.length,i=0;i<t;i++)n+=e.charAt(Math.floor(Math.random()*o));return n},t.removeItem=function(t,e){for(var n=t.concat(),o=0;o<n.length;o++)if(e==n[o]){t.splice(o,1);break}},t.weightRandomIdx=function(t){if(t.length<=1)return 0;for(var e=0,n=0;n<t.length;n++)e+=t[n];var o=Math.random()*e,i=0,r=0;for(n=0;n<t.length;n++){if(r=i+t[n],i<o&&o<=r)return n;i=r}return 0},t.angleTowards=function(t,e,n){var o=(e%=360)-(t%=360);o>180?e=t-(360-o):o<-180&&(e=t+(360+o));var i=e-t;return n>Math.abs(i)?e:((t+n*Math.sign(i))%360+360)%360},t.createQueueCircle=function(t,e){if(e%4!=0)throw"\u751f\u6210\u7684\u5728\u5706\u4e0a\u7684\u70b9\u7684\u603b\u6570\u9519\u8bef\uff0c\u4e0d\u662f4\u7684\u500d\u6570"+e;for(var n=e/4,o=[],i=1;i<n;i++){var r=t*Math.sin(Math.PI/180*i/n*90),c=Math.sqrt(t*t-r*r);o.push([c,r],[c,-r],[-c,r],[-c,-r])}return o.push([0,t],[0,-t],[t,0],[-t,0]),o},t.createQueueHeart=function(t,e){if(e<20)throw"total\u8fc7\u5c0f\uff0c\u65e0\u6cd5\u751f\u6210\u5fc3\u5f62\u65b9\u7a0b";var n=2*Math.PI/e;t/=16;for(var o=[];e;){var i=n*e,r=16*Math.pow(Math.sin(i),3),c=13*Math.cos(i)-5*Math.cos(2*i)-2*Math.cos(3*i)-Math.cos(4*i);r*=t,c*=t,o.push([r,c]),e--}return o},t}();n.default=i,cc._RF.pop()},{}],TNode:[function(t,e,n){"use strict";cc._RF.push(e,"96c62ZX63BBWq+ZyEBTJQ8A","TNode"),Object.defineProperty(n,"__esModule",{value:!0});var o=t("../common/ImageCommon"),i=function(){function t(){}return t.bindNodeTreeAndButton=function(t,e){if(t&&e)for(var n="",o=0,i=e.children;o<i.length;o++){var r=i[o];(n=r.name).startsWith("_")||(t[n]=r,(r.getComponent(cc.Button)||r.getComponent(cc.Toggle))&&t["onClick_"+n]&&r.on("click",t["onClick_"+n],t)),r.childrenCount&&this.bindNodeTreeAndButton(t,r)}},t.setImageToTarget=function(t,e){o.default.setImageToTarget(t,e)},t.setLabelValue=function(t,e){var n=null;t instanceof cc.Node?(n=t.getComponent(cc.Label))||(n=t.getComponent(cc.RichText)):n=t,n.string=e},t.setImgToTarget=function(t,e,n){o.default.loadImgToTarget(e,t,n)},t}();n.default=i,cc._RF.pop()},{"../common/ImageCommon":"ImageCommon"}],TableConfig:[function(t,e){"use strict";cc._RF.push(e,"d0c33svABlNhZ9fiXf9iEu7","TableConfig");var n=new function(){this.Audio={TName:"audio",Bgm:"Bgm",Selected:"Selected",Eliminate:"Eliminate"},this.Image={TName:"image"},this.Item={TName:"item",101:"101",102:"102",201:"201",202:"202",203:"203"},this.Level={TName:"level",Level1:"Level1",Level2:"Level2",Level3:"Level3",Level4:"Level4",Level5:"Level5",Level6:"Level6"}};window.TableConfig=n,cc._RF.pop()},{}],TempBtn:[function(t,e,n){"use strict";cc._RF.push(e,"a7493q8Hh1JApoTbK3U3w3O","TempBtn");var o,i=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),r=this&&this.__decorate||function(t,e,n,o){var i,r=arguments.length,c=r<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(t,e,n,o);else for(var a=t.length-1;a>=0;a--)(i=t[a])&&(c=(r<3?i(c):r>3?i(e,n,c):i(e,n))||c);return r>3&&c&&Object.defineProperty(e,n,c),c};Object.defineProperty(n,"__esModule",{value:!0});var c=t("../core/common/LoadCommon"),a=t("../core/system/ItemSystem"),s=t("../core/tools/TNode"),u=t("../core/ui/UIMgr"),l=t("../ui/UIMain"),f=cc._decorator,d=f.ccclass,h=(f.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.config=null,e.SpIcon=null,e.LblName=null,e.LblCount=null,e.curCount=0,e}return i(e,t),e.prototype.onLoad=function(){s.default.bindNodeTreeAndButton(this,this.node),this.node.on("click",this.use,this)},e.prototype.init=function(t){var e=this;this.config=a.default.getById(t),this.curCount=50,s.default.setLabelValue(this.LblName,this.config.name),s.default.setLabelValue(this.LblCount,""+this.curCount),c.default.loadAsset({path:"res/"+this.config.icon,bundleName:"ui",type:cc.SpriteFrame}).then(function(t){e.SpIcon.getComponent(cc.Sprite).spriteFrame=t})},e.prototype.use=function(){if(console.log("11111111111111111111122222222222222222222"),console.log("coin ==="+GameConfig.CoinNum),this.curCount>GameConfig.CoinNum)u.default.showTip("\u91d1\u5e01\u4e0d\u8db3");else{GameConfig.CoinNum-=this.curCount,l.default.instance.setCoinView(GameConfig.CoinNum),console.log("num ===="+GameConfig.CoinNum);var t=!1;switch(this.config.id){case TableConfig.Item[201]:t=l.default.instance.revoke();break;case TableConfig.Item[202]:t=l.default.instance.help();break;case TableConfig.Item[203]:t=l.default.instance.refreshChange()}t&&(this.curCount--,a.default.reduceItem(this.config.id,1))}},r([d],e)}(cc.Component));n.default=h,cc._RF.pop()},{"../core/common/LoadCommon":"LoadCommon","../core/system/ItemSystem":"ItemSystem","../core/tools/TNode":"TNode","../core/ui/UIMgr":"UIMgr","../ui/UIMain":"UIMain"}],TempGrid:[function(t,e,n){"use strict";cc._RF.push(e,"255d5kU4+tICr4sUsyph+sA","TempGrid");var o,i=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),r=this&&this.__decorate||function(t,e,n,o){var i,r=arguments.length,c=r<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(t,e,n,o);else for(var a=t.length-1;a>=0;a--)(i=t[a])&&(c=(r<3?i(c):r>3?i(e,n,c):i(e,n))||c);return r>3&&c&&Object.defineProperty(e,n,c),c};Object.defineProperty(n,"__esModule",{value:!0});var c=t("../core/common/LoadCommon"),a=t("../core/tools/TNode"),s=cc._decorator,u=s.ccclass,l=(s.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.SpShadow=null,e.SpIcon=null,e.id=0,e.row=0,e.col=0,e.order=0,e.isLock=!1,e.isSelected=!1,e}return i(e,t),e.prototype.onLoad=function(){a.default.bindNodeTreeAndButton(this,this.node)},e.prototype.init=function(t,e,n,o){var i=this;this.id=t,this.row=e,this.col=n,this.order=o,c.default.loadAsset({path:"res/imgs/img"+t,bundleName:"prefabs",type:cc.SpriteFrame}).then(function(t){i.SpIcon.getComponent(cc.Sprite).spriteFrame=t})},e.prototype.setShadow=function(t){this.isLock=t,this.SpShadow.active=t},e.prototype.selected=function(t){this.isSelected=t},r([u],e)}(cc.Component));n.default=l,cc._RF.pop()},{"../core/common/LoadCommon":"LoadCommon","../core/tools/TNode":"TNode"}],Tip:[function(t,e,n){"use strict";cc._RF.push(e,"1b73cmdwpNKRIrTJOqidUMS","Tip");var o,i=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),r=this&&this.__decorate||function(t,e,n,o){var i,r=arguments.length,c=r<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(t,e,n,o);else for(var a=t.length-1;a>=0;a--)(i=t[a])&&(c=(r<3?i(c):r>3?i(e,n,c):i(e,n))||c);return r>3&&c&&Object.defineProperty(e,n,c),c};Object.defineProperty(n,"__esModule",{value:!0});var c=cc._decorator,a=c.ccclass,s=c.property,u=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.bg=null,e.lblContent=null,e}return i(e,t),e.prototype.init=function(t){var e=this;this.lblContent.string=t,this.lblContent._forceUpdateRenderData&&this.lblContent._forceUpdateRenderData(),this.bg.height=this.lblContent.node.height+20;for(var n=0,o=this.bg.children;n<o.length;n++)o[n].height=this.bg.height;this.node.scale=0,cc.tween(this.node).to(.3,{scale:1}).delay(.2).by(.8,{opacity:-100,y:120}).call(function(){e.node.destroy()}).start()},r([s({type:cc.Node,displayName:"\u80cc\u666f"})],e.prototype,"bg",void 0),r([s({type:cc.Label,displayName:"\u5185\u5bb9"})],e.prototype,"lblContent",void 0),r([a],e)}(cc.Component);n.default=u,cc._RF.pop()},{}],UIEditor:[function(t,e,n){"use strict";cc._RF.push(e,"a28acQB7K1LBqbanO7+lKTY","UIEditor");var o=this&&this.__spreadArrays||function(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;var o=Array(t),i=0;for(e=0;e<n;e++)for(var r=arguments[e],c=0,a=r.length;c<a;c++,i++)o[i]=r[c];return o};Object.defineProperty(n,"__esModule",{value:!0});var i=t("../core/common/LoadCommon"),r=t("../core/ui/UIMgr"),c=t("../Interface"),a=function(){function t(){this.node=null,this.name="UIEditor",this.active=!1,this.sort=c.UISort.NORMAL,this.bundle="ui",this.dependencies=[this.bundle],this.Root=null,this.SpDot=null,this.EditBoxOrder=null,this.EditBoxLevel=null,this.curCards=[],this.curNodes=[],this.isCreate=!1,this.isDelete=!1,this.editBoxOrder=null,this.editBoxLevel=null,this.isCanCreate=!1,this.interval=0,this.tempPrefab=null}return Object.defineProperty(t,"instance",{get:function(){return this._instance||(this._instance=new t),this._instance},enumerable:!1,configurable:!0}),t.prototype.open=function(t){r.default.open(this,this.init,t)},t.prototype.init=function(){var t=this;this.isCreate=!0,this.isCanCreate=!0,this.editBoxLevel=this.EditBoxLevel.getComponent(cc.EditBox),this.editBoxOrder=this.EditBoxOrder.getComponent(cc.EditBox),this.SpDot.parent=null;for(var e=this.Root.getContentSize(),n=cc.size(25,31.25),o=Math.floor(e.width/n.width)-1,r=Math.floor(e.height/n.height)-1,c=1;c<=o;c++)for(var a=1;a<=r;a++){var s=cc.instantiate(this.SpDot);s.parent=this.Root,s.x=c*n.width,s.y=-a*n.height,s.row=c,s.col=a,s.zIndex=cc.macro.MAX_ZINDEX}return this.checkCardOrder(),i.default.loadBundle("prefabs").then(function(){i.default.loadAsset({path:"res/Grid",bundleName:"prefabs",type:cc.Prefab}).then(function(e){t.tempPrefab=e,t.Root.on(cc.Node.EventType.TOUCH_START,t.createCard,t),t.Root.on(cc.Node.EventType.TOUCH_MOVE,t.createCard,t)})}),!0},t.prototype.createCard=function(t){var e=this;if(!this.isDelete&&this.isCreate&&this.isCanCreate){this.isCanCreate=!1;for(var n=o(this.Root.children),i=function(o){var i=n[o];if(i.name!=r.SpDot.name)return"continue";if(i.getBoundingBoxToWorld().contains(t.getLocation())){var c={row:i.row,col:i.col,order:Number(r.editBoxOrder.string)},a=cc.instantiate(r.tempPrefab);a.parent=r.Root,a.setPosition(i.getPosition()),a.on(cc.Node.EventType.TOUCH_START,function(){a.isValid&&cc.isValid(a,!0)&&e.isDelete&&(e.curCards.splice(e.curCards.indexOf(c),1),e.curNodes.splice(e.curNodes.indexOf(a),1),a.destroy(),e.checkCardOrder())},r),a.zIndex=Number(r.editBoxOrder.string),r.curCards.push(c),r.curNodes.push(a),r.checkCardOrder()}},r=this,c=0;c<n.length;c++)i(c)}},t.prototype.update=function(t){this.isCanCreate||(this.interval+=t,this.interval>=.2&&(this.interval=0,this.isCanCreate=!0))},t.prototype.checkCardOrder=function(){for(var t=0;t<this.curCards.length;t++){for(var e=!0,n=0;n<this.curCards.length;n++)t!=n&&this.curCards[t].order<this.curCards[n].order&&Math.abs(this.curCards[t].row-this.curCards[n].row)<=2&&Math.abs(this.curCards[t].col-this.curCards[n].col)<=2&&(e=!1);this.curNodes[t].getChildByName("SpShadow").active=!e}var o=JSON.stringify(this.curCards);0==this.curCards.length&&(o="\u5feb\u6765\u7f16\u8f91\u5173\u5361\u5427\uff01"),this.curCards.length%3!=0&&(o="\u5361\u724c\u4e0d\u8db3\u4e09\u7684\u500d\u6570\uff01\u76ee\u524d\u6570\u91cf\uff1a"+this.curCards.length),this.editBoxLevel.string=o},t.prototype.onClick_ToggleCreate=function(){this.isCreate=!0,this.isDelete=!1},t.prototype.onClick_ToggleDelete=function(){this.isCreate=!1,this.isDelete=!0},t.prototype.close=function(t){r.default.close(this.name,t)},t._instance=null,t}();n.default=a,cc._RF.pop()},{"../Interface":"Interface","../core/common/LoadCommon":"LoadCommon","../core/ui/UIMgr":"UIMgr"}],UIFail:[function(t,e,n){"use strict";cc._RF.push(e,"7e1dfQea4BMy6uJy1Y1hgqS","UIFail"),Object.defineProperty(n,"__esModule",{value:!0});var o=t("../core/ui/UIMgr"),i=t("../Interface"),r=t("./UIMain"),c=function(){function t(){this.node=null,this.name="UIFail",this.active=!1,this.sort=i.UISort.NORMAL,this.bundle="ui",this.dependencies=[this.bundle]}return Object.defineProperty(t,"instance",{get:function(){return this._instance||(this._instance=new t),this._instance},enumerable:!1,configurable:!0}),t.prototype.open=function(t){o.default.open(this,this.init,t)},t.prototype.init=function(){return!0},t.prototype.onClick_BtnConfirm=function(){r.default.instance.reset(),this.close()},t.prototype.close=function(t){o.default.close(this.name,t)},t._instance=null,t}();n.default=c,cc._RF.pop()},{"../Interface":"Interface","../core/ui/UIMgr":"UIMgr","./UIMain":"UIMain"}],UIMain:[function(t,e,n){"use strict";cc._RF.push(e,"44421sq4axN6JuIxSC4DCln","UIMain");var o=this&&this.__awaiter||function(t,e,n,o){return new(n||(n=Promise))(function(i,r){function c(t){try{s(o.next(t))}catch(e){r(e)}}function a(t){try{s(o.throw(t))}catch(e){r(e)}}function s(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n(function(t){t(e)})).then(c,a)}s((o=o.apply(t,e||[])).next())})},i=this&&this.__generator||function(t,e){var n,o,i,r,c={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return r={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function a(t){return function(e){return s([t,e])}}function s(r){if(n)throw new TypeError("Generator is already executing.");for(;c;)try{if(n=1,o&&(i=2&r[0]?o.return:r[0]?o.throw||((i=o.return)&&i.call(o),0):o.next)&&!(i=i.call(o,r[1])).done)return i;switch(o=0,i&&(r=[2&r[0],i.value]),r[0]){case 0:case 1:i=r;break;case 4:return c.label++,{value:r[1],done:!1};case 5:c.label++,o=r[1],r=[0];continue;case 7:r=c.ops.pop(),c.trys.pop();continue;default:if(!(i=(i=c.trys).length>0&&i[i.length-1])&&(6===r[0]||2===r[0])){c=0;continue}if(3===r[0]&&(!i||r[1]>i[0]&&r[1]<i[3])){c.label=r[1];break}if(6===r[0]&&c.label<i[1]){c.label=i[1],i=r;break}if(i&&c.label<i[2]){c.label=i[2],c.ops.push(r);break}i[2]&&c.ops.pop(),c.trys.pop();continue}r=e.call(t,c)}catch(a){r=[6,a],o=0}finally{n=i=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}};Object.defineProperty(n,"__esModule",{value:!0});var r=t("../core/common/AudioCommon"),c=t("../core/common/ConfigCommon"),a=t("../core/common/LoadCommon"),s=t("../core/common/LocalStorageCommon"),u=t("../core/tools/TMath"),l=t("../core/tools/TNode"),f=t("../core/ui/UIMgr"),d=t("../Interface"),h=t("../prefab/TempBtn"),p=t("../prefab/TempGrid"),m=t("./UIFail"),g=t("./UIVictory"),y=function(){function t(){this.node=null,this.name="UIMain",this.active=!1,this.sort=d.UISort.NORMAL,this.bundle="ui",this.dependencies=[this.bundle],this.Root=null,this.cards=[],this.selectedCards=[],this.isEliminate=!1,this.steps=[],this.LayoutContent=null,this.tempPrefab=null,this.isRevoke=!1,this.props=null,this.TempBtn=null,this.LayoutProp=null,this.isRefresh=!1,this.LblLevel=null,this.BackGround=null,this.CoinNode=null}return Object.defineProperty(t,"instance",{get:function(){return this._instance||(this._instance=new t),this._instance},enumerable:!1,configurable:!0}),t.prototype.open=function(t){f.default.open(this,this.init,t)},t.prototype.init=function(){var t=this;r.default.play(TableConfig.Audio.Bgm,!0),this.props=[TableConfig.Item[201],TableConfig.Item[202],TableConfig.Item[203]],this.TempBtn.parent=null,a.default.loadBundle("prefabs").then(function(){a.default.loadAsset({path:"res/Grid",bundleName:"prefabs",type:cc.Prefab}).then(function(e){t.tempPrefab=e,t.reset()})});for(var e=0,n=this.BackGround.children;e<n.length;e++){var o=n[e];cc.tween(o).repeatForever(cc.tween(o).to(.2,{scaleY:.8}).to(.2,{scaleY:1})).start()}return l.default.setLabelValue(this.CoinNode,""+GameConfig.CoinNum),!0},t.prototype.setCoinView=function(t){l.default.setLabelValue(this.CoinNode,""+t),s.default.setInt(GameConfig.LocalKeys.CurCoin,GameConfig.CoinNum)},t.prototype.reset=function(){this.LayoutProp.destroyAllChildren(),this.Root.destroyAllChildren(),this.selectedCards.length=0,this.isEliminate=!1,this.cards.length=0,this.steps.length=0,this.LayoutContent.destroyAllChildren(),this.initCard(this.tempPrefab),this.initProp()},t.prototype.initProp=function(){for(var t=0;t<this.props.length;t++){var e=cc.instantiate(this.TempBtn);e.parent=this.LayoutProp,e.getComponent(h.default).init(this.props[t])}},t.prototype.refreshChange=function(){var t=this;if(this.isRevoke||this.isRefresh)return!1;this.isRefresh=!0;for(var e=[],n=0;n<this.cards.length;n++)e.push(this.cards[n].id);u.default.shuffleArray(e);var o=function(n){var o=i.cards[n],r=o.node,c=cc.size(25,31.25),a=cc.v2(o.row*c.width,-o.col*c.height);cc.tween(r).to(.5,{position:cc.v3(i.Root.width/2,-i.Root.height/2,0)}).call(function(){for(var n=0;n<e.length;n++){var o=t.cards[n];o.init(e[n],o.row,o.col,o.order)}}).delay(.2).to(.5,{x:a.x,y:a.y}).call(function(){n==t.cards.length-1&&(t.isRefresh=!1)}).start()},i=this;for(n=0;n<this.cards.length;n++)o(n);return!0},t.prototype.revoke=function(){var t=this;if(this.isRevoke||this.isRefresh)return!1;if(this.steps.length<=0)return!1;this.isRevoke=!0;var e=this.steps.pop(),n=e.node.convertToWorldSpaceAR(cc.v2(0,0));e.node.setPosition(this.Root.convertToNodeSpaceAR(n)),e.node.parent=this.Root;var o=cc.size(25,31.25),i=cc.v2(e.row*o.width,-e.col*o.height);return cc.tween(e.node).to(.2,{x:i.x,y:i.y}).call(function(){e.selected(!1),t.cards.push(e),t.selectedCards.splice(t.selectedCards.indexOf(e),1),t.checkCardOrder(),t.isRevoke=!1}).start(),!0},t.prototype.help=function(){if(this.isRevoke||this.isRefresh)return!1;for(var t=u.default.random(0,this.cards.length-1,!0),e=this.cards[t].id,n=null,o=0,i=0;i<this.cards.length;i++)if((n=this.cards[i]).id==e&&(this.cards.splice(i,1),i--,n.node.destroy(),++o>=3)){this.checkCardOrder();break}if(o<3)for(i=0;i<this.selectedCards.length&&!((n=this.selectedCards[i]).id==e&&(this.selectedCards.splice(i,1),i--,n.node.destroy(),++o>=3));i++);return r.default.play(TableConfig.Audio.Eliminate),0==this.cards.length&&g.default.instance.open(),!0},t.prototype.initCard=function(t){return o(this,void 0,void 0,function(){var e,n,o,r,a,f,d,h,m,g,y=this;return i(this,function(){for(e=s.default.getInt(GameConfig.LocalKeys.CurLevel),n=c.default.getRow(TableConfig.Level.TName,"Level"+e),l.default.setLabelValue(this.LblLevel,n.id),o=n.data,r=o.length/3,a=[],g=0;g<r;g++)f=u.default.random(1,29,!0),a.push(f,f,f);for(u.default.shuffleArray(a),d=cc.size(25,31.25),h=function(e){var n=o[e],i=cc.instantiate(t);m.Root.addChild(i,n.order);var r=i.getComponent(p.default),c=cc.v2(n.row*d.width,-n.col*d.height);i.setPosition(c),r.init(a[e],n.row,n.col,n.order),m.cards.push(r),cc.tween(i).to(.5,{position:cc.v3(m.Root.width/2,-m.Root.height/2,0)}).delay(.2).to(.5,{x:c.x,y:c.y}).call(function(){i.on(cc.Node.EventType.TOUCH_START,y.onSelectCard.bind(y,r),y),e==o.length-1&&y.checkCardOrder()}).start()},m=this,g=0;g<o.length;g++)h(g);return[2]})})},t.prototype.onSelectCard=function(t){t.isLock||t.isSelected||7==this.selectedCards.length||this.isEliminate||(this.cards.splice(this.cards.indexOf(t),1),this.selectedCards.push(t),t.selected(!0),this.doEliminate(t),this.steps.push(t),r.default.play(TableConfig.Audio.Selected))},t.prototype.checkCardOrder=function(){for(var t=0;t<this.cards.length;t++){for(var e=!0,n=0;n<this.cards.length;n++)t!=n&&this.cards[t].order<this.cards[n].order&&Math.abs(this.cards[t].row-this.cards[n].row)<=2&&Math.abs(this.cards[t].col-this.cards[n].col)<=2&&(e=!1);this.cards[t].setShadow(!e)}},t.prototype.doEliminate=function(t){var e=this;this.isEliminate=!0,this.LayoutContent.getComponent(cc.Layout).enabled=!1;var n=this.findEqualCard(t),o=t.node.width/2;cc.Tween.stopAllByTarget(t.node);var i=null;if(n){i=n.node.convertToWorldSpaceAR(cc.v2());for(var r=this.selectedCards.indexOf(n),c=function(n){var c=a.selectedCards[n];if(c.node.zIndex=n,n<=r)return"continue";c.node.zIndex=n+1,cc.tween(c.node).by(.1,{x:t.uuid==c.uuid?0:2*o+5}).call(function(){n==e.selectedCards.length-1&&e.insertAction(t,cc.v2(i.x+2*o+5,i.y),r+1)}).start()},a=this,s=0;s<this.selectedCards.length;s++)c(s)}else{var u=this.LayoutContent.children[this.LayoutContent.childrenCount-1],l=-this.LayoutContent.width/2+o;u&&(l=u.x+5+o),i=this.LayoutContent.convertToWorldSpaceAR(cc.v2(l,5)),this.insertAction(t,cc.v2(i.x,i.y))}},t.prototype.insertAction=function(t,e,n){var r=this;void 0===n&&(n=null);var c=t.node.convertToWorldSpaceAR(cc.v2());t.node.parent=this.node,t.node.setPosition(t.node.parent.convertToNodeSpaceAR(c)),t.node.zIndex=cc.macro.MAX_ZINDEX,e=t.node.parent.convertToNodeSpaceAR(e),cc.tween(t.node).to(.2,{position:cc.v3(e.x,e.y,0)}).call(function(){return o(r,void 0,void 0,function(){return i(this,function(e){switch(e.label){case 0:return null!=n&&(t.node.zIndex=n),t.node.parent=this.LayoutContent,t.node.y=5,null==n?[3,2]:[4,this.checkEqual(t.id)];case 1:e.sent(),this.selectedCards.sort(function(t,e){return t.node.zIndex-e.node.zIndex}),e.label=2;case 2:return this.LayoutContent.getComponent(cc.Layout).enabled=!0,this.checkCardOrder(),this.isEliminate=!1,7==this.selectedCards.length?(m.default.instance.open(),[2]):(0==this.cards.length&&g.default.instance.open(),[2])}})})}).start()},t.prototype.findEqualCard=function(t){for(var e=null,n=this.selectedCards.length-1;n>=0&&((e=this.selectedCards[n]).uuid==t.uuid||e.id!=t.id);n--)e=null;return e},t.prototype.checkEqual=function(t){var e=this;return new Promise(function(n){for(var o=[],i=0,c=e.selectedCards;i<c.length;i++)(l=c[i]).id==t&&o.push(l);if(3==o.length){for(var a=function(t){var i=t.node;cc.Tween.stopAllByTarget(i),cc.tween(i).to(.1,{scale:0}).call(function(){var r=e.selectedCards.indexOf(t);e.selectedCards.splice(r,1),e.steps.splice(e.steps.indexOf(t),1),i.destroy(),o.pop(),0==o.length&&n(!0)}).start()},s=0,u=o;s<u.length;s++){var l;a(l=u[s])}r.default.play(TableConfig.Audio.Eliminate)}else n(!1)})},t.prototype.close=function(t){f.default.close(this.name,t)},t._instance=null,t}();n.default=y,cc._RF.pop()},{"../Interface":"Interface","../core/common/AudioCommon":"AudioCommon","../core/common/ConfigCommon":"ConfigCommon","../core/common/LoadCommon":"LoadCommon","../core/common/LocalStorageCommon":"LocalStorageCommon","../core/tools/TMath":"TMath","../core/tools/TNode":"TNode","../core/ui/UIMgr":"UIMgr","../prefab/TempBtn":"TempBtn","../prefab/TempGrid":"TempGrid","./UIFail":"UIFail","./UIVictory":"UIVictory"}],UIMgr:[function(t,e,n){"use strict";cc._RF.push(e,"4c89dFmrCxIXJEAtRNRi6TS","UIMgr");var o,i=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),r=this&&this.__decorate||function(t,e,n,o){var i,r=arguments.length,c=r<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(t,e,n,o);else for(var a=t.length-1;a>=0;a--)(i=t[a])&&(c=(r<3?i(c):r>3?i(e,n,c):i(e,n))||c);return r>3&&c&&Object.defineProperty(e,n,c),c},c=this&&this.__awaiter||function(t,e,n,o){return new(n||(n=Promise))(function(i,r){function c(t){try{s(o.next(t))}catch(e){r(e)}}function a(t){try{s(o.throw(t))}catch(e){r(e)}}function s(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n(function(t){t(e)})).then(c,a)}s((o=o.apply(t,e||[])).next())})},a=this&&this.__generator||function(t,e){var n,o,i,r,c={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return r={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function a(t){return function(e){return s([t,e])}}function s(r){if(n)throw new TypeError("Generator is already executing.");for(;c;)try{if(n=1,o&&(i=2&r[0]?o.return:r[0]?o.throw||((i=o.return)&&i.call(o),0):o.next)&&!(i=i.call(o,r[1])).done)return i;switch(o=0,i&&(r=[2&r[0],i.value]),r[0]){case 0:case 1:i=r;break;case 4:return c.label++,{value:r[1],done:!1};case 5:c.label++,o=r[1],r=[0];continue;case 7:r=c.ops.pop(),c.trys.pop();continue;default:if(!(i=(i=c.trys).length>0&&i[i.length-1])&&(6===r[0]||2===r[0])){c=0;continue}if(3===r[0]&&(!i||r[1]>i[0]&&r[1]<i[3])){c.label=r[1];break}if(6===r[0]&&c.label<i[1]){c.label=i[1],i=r;break}if(i&&c.label<i[2]){c.label=i[2],c.ops.push(r);break}i[2]&&c.ops.pop(),c.trys.pop();continue}r=e.call(t,c)}catch(a){r=[6,a],o=0}finally{n=i=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}};Object.defineProperty(n,"__esModule",{value:!0});var s=t("../../Interface"),u=t("../../prefab/Tip"),l=t("../common/LoadCommon"),f=t("../tools/TNode"),d=cc._decorator,h=d.ccclass,p=(d.property,null),m=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._layers=null,e}var n;return i(e,t),n=e,Object.defineProperty(e,"instance",{get:function(){return n._instance},enumerable:!1,configurable:!0}),e.Root=function(t){return n.instance._layers[t]},e.prototype.onLoad=function(){this._layers=[],n._instance=this,n._windows=Object.create(null);for(var t=Object.keys(s.UISort),e=t.length>>1;e<t.length;e++){var o=new cc.Node(t[e]);o.parent=this.node;var i=o.addComponent(cc.Widget);i.isAlignBottom=!0,i.isAlignTop=!0,i.isAlignLeft=!0,i.isAlignRight=!0,i.top=0,i.bottom=0,i.left=0,i.right=0,this._layers.push(o)}},e.prototype.update=function(t){for(var e in n._windows)(p=n._windows[e])&&p.active&&p.update&&p.update(t)},e.open=function(t,e,n){return c(this,void 0,void 0,function(){var o,i,r,c=this;return a(this,function(){return o=t.name,this._windows[o]?this.__open(this._windows[o],e,n):(this._windows[o]=t,i=t.dependencies,r=t.bundle||"ui",i&&l.default.loadBundles(i).then(function(){l.default.loadAsset({path:"prefabs/"+o,bundleName:r,type:cc.Prefab}).then(function(i){i?c._open(t,i,e,n):console.log("[UIMgr][open] window\uff1a["+o+"]\uff0cload filed")})})),[2]})})},e._open=function(t,e,n,o){if(null!=e){var i=this.Root(t.sort),r=cc.instantiate(e);t.node=r,i.addChild(r),r.setParent(i),f.default.bindNodeTreeAndButton(t,r),this.__open(t,n,o)}else null!=o&&o(!1)},e.__open=function(t,e,n){var o=null!=t.node;o&&(o=e.call(t,t.node,!0)),o?(t.node&&(t.node.active=!0),t.active=!0):(t.node&&t.node.destroy(),t.active=!1),n&&n(o)},e.close=function(t,e,n){var o=this._windows[t];e?(o.node&&o.node.destroy(),o.active=!1,delete this._windows[t]):(o.node&&(o.node.active=!1),o.active=!1),n&&n()},e.showTip=function(t){var e=this;l.default.loadBundle("prefabs").then(function(){l.default.loadAsset({path:"res/Tip",bundleName:"prefabs",type:cc.Prefab}).then(function(n){var o=cc.instantiate(n);o.parent=e.Root(s.UISort.TOP),o.setPosition(0,0),o.getComponent(u.default).init(t)})})},e._windows=null,e._instance=null,n=r([h],e)}(cc.Component);n.default=m,cc._RF.pop()},{"../../Interface":"Interface","../../prefab/Tip":"Tip","../common/LoadCommon":"LoadCommon","../tools/TNode":"TNode"}],UITemp:[function(t,e,n){"use strict";cc._RF.push(e,"bd075IVBK5LWpX+/DeBM1q5","UITemp"),Object.defineProperty(n,"__esModule",{value:!0});var o=t("../core/ui/UIMgr"),i=t("../Interface"),r=function(){function t(){this.node=null,this.name="UITemp",this.active=!1,this.sort=i.UISort.NORMAL,this.bundle="ui",this.dependencies=[this.bundle]}return Object.defineProperty(t,"instance",{get:function(){return this._instance||(this._instance=new t),this._instance},enumerable:!1,configurable:!0}),t.prototype.open=function(t){o.default.open(this,this.init,t)},t.prototype.init=function(){return!0},t.prototype.close=function(t){o.default.close(this.name,t)},t._instance=null,t}();n.default=r,cc._RF.pop()},{"../Interface":"Interface","../core/ui/UIMgr":"UIMgr"}],UIVictory:[function(t,e,n){"use strict";cc._RF.push(e,"bfedexf0RdB2op8tU49PBRZ","UIVictory"),Object.defineProperty(n,"__esModule",{value:!0});var o=t("../core/common/ConfigCommon"),i=t("../core/common/LocalStorageCommon"),r=t("../core/ui/UIMgr"),c=t("../Interface"),a=t("./UIMain"),s=function(){function t(){this.node=null,this.name="UIVictory",this.active=!1,this.sort=c.UISort.NORMAL,this.bundle="ui",this.dependencies=[this.bundle]}return Object.defineProperty(t,"instance",{get:function(){return this._instance||(this._instance=new t),this._instance},enumerable:!1,configurable:!0}),t.prototype.open=function(t){r.default.open(this,this.init,t)},t.prototype.init=function(){var t=i.default.getInt(GameConfig.LocalKeys.CurLevel);console.log("curlevel ====="+t);var e=o.default.getRow(TableConfig.Level.TName,"Level"+(t+1));return console.log(e),e&&i.default.setInt(GameConfig.LocalKeys.CurLevel,++t),!0},t.prototype.onClick_BtnConfirm=function(){GameConfig.CoinNum+=50,a.default.instance.setCoinView(GameConfig.CoinNum),i.default.setInt(GameConfig.LocalKeys.CurCoin,GameConfig.CoinNum),a.default.instance.reset(),this.close()},t.prototype.close=function(t){r.default.close(this.name,t)},t._instance=null,t}();n.default=s,cc._RF.pop()},{"../Interface":"Interface","../core/common/ConfigCommon":"ConfigCommon","../core/common/LocalStorageCommon":"LocalStorageCommon","../core/ui/UIMgr":"UIMgr","./UIMain":"UIMain"}]},{},["Interface","GameConfig","TableConfig","AudioCommon","ConfigCommon","ImageCommon","LoadCommon","LocalStorageCommon","LinkedList","Stack","ItemSystem","TAction","TMath","TNode","UIMgr","TempBtn","TempGrid","Tip","Loading","Main","UIEditor","UIFail","UIMain","UITemp","UIVictory"]);